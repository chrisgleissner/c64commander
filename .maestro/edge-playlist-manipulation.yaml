appId: uk.gleissner.c64commander
---
- runFlow: subflows/open-play-add-items.yaml

# Add a known SID from the C64 Ultimate mock source.
- tapOn:
    text: "Add file / folder"
- extendedWaitUntil:
    visible: "Select items"
    timeout: 10000
- extendedWaitUntil:
    visible: "Open Usb0"
    timeout: 20000
- tapOn: "Open Usb0"

- extendedWaitUntil:
    visible: "Open Music"
    timeout: 20000
- tapOn: "Open Music"

- extendedWaitUntil:
    visible: "Select Mock_Tune_0001.sid"
    timeout: 20000

# Select the file and confirm.
- tapOn: "Select Mock_Tune_0001.sid"
- tapOn: "Add to playlist"

# Wait for playlist to show the new entry (header + item => 2 items).
- extendedWaitUntil:
    visible: "2 items"
    timeout: 30000
- takeScreenshot: playlist-item-added

# Start playback via transport controls and verify it is active.
- tapOn: "Play"
- extendedWaitUntil:
    visible: "Stop"
    timeout: 10000

# Select the playlist item via its checkbox and remove it.
- tapOn: "Select Mock_Tune_0001.sid"
- extendedWaitUntil:
    visible: "1 selected"
    timeout: 10000
- extendedWaitUntil:
    visible: "Remove selected items"
    timeout: 10000
- tapOn: "Remove selected items"
- extendedWaitUntil:
    visible: "No tracks in playlist yet."
    timeout: 30000
- assertVisible: "No tracks in playlist yet."
- takeScreenshot: playlist-item-removed
