appId: uk.gleissner.c64commander
tags:
  - edge
  - slow
env:
  SHORT_TIMEOUT: ${SHORT_TIMEOUT || "5000"}
  TIMEOUT: ${TIMEOUT || "15000"}
  LONG_TIMEOUT: ${LONG_TIMEOUT || "20000"}
---
- runFlow: subflows/launch-and-wait.yaml
- tapOn:
    point: "75%,95%"
- extendedWaitUntil:
    visible: "Settings"
    timeout: ${SHORT_TIMEOUT}
- waitForAnimationToEnd

# Scroll until the HVSC checkbox is in view (bounded).
- scrollUntilVisible:
    element:
      id: hvsc-flag
    direction: DOWN
    speed: 80
    timeout: ${LONG_TIMEOUT}

# Expect the flag to be enabled by default on native builds.
- assertVisible:
    id: hvsc-flag
    checked: true

- takeScreenshot: hvsc-enabled

# Restart and confirm it persisted.
- launchApp:
    stopApp: true
- runFlow: subflows/launch-and-wait.yaml
- tapOn:
    point: "75%,95%"
- extendedWaitUntil:
    visible: "Settings"
    timeout: ${SHORT_TIMEOUT}
- waitForAnimationToEnd
- scrollUntilVisible:
    element:
      id: hvsc-flag
    direction: DOWN
    speed: 80
    timeout: ${LONG_TIMEOUT}
- assertVisible:
    id: hvsc-flag
    checked: true
- takeScreenshot: hvsc-persisted
